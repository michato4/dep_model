function [j] = stratton_to_jackson(s)
%   Convert Stratton's type of cartesian multipoles to Jackson's type
	if numel(s) <= 3^1
        j = s;
    elseif numel(s) == 3^2
        % qudrupole       
        p2 = 3*s;
        p2(1,1) = 2*s(1,1)-s(2,2)-s(3,3);
        p2(2,2) = 2*s(2,2)-s(1,1)-s(3,3);
        p2(3,3) = 2*s(3,3)-s(2,2)-s(1,1);
        j = p2;
        j = 3*s;
    elseif numel(s) == 3^3
        % octupole       
        p3 = s;
        O111J = 15*p3(1,1,1)-3*(p3(1,1,1)*3+p3(1,2,2)*3+p3(1,3,3)*3);
        O112J = 15*p3(1,1,2)-3*(p3(1,1,2)+p3(2,2,2)+p3(3,3,2));
        O113J = 15*p3(1,1,3)-3*(p3(1,1,3)+p3(3,2,2)+p3(3,3,3));
        O222J = 15*p3(2,2,2)-3*(p3(1,1,2)*3+p3(2,2,2)*3+p3(3,3,2)*3);
        O123J = 15*p3(1,2,3);
        O333J = 15*p3(3,3,3)-3*(p3(1,1,3)*3+p3(3,2,2)*3+p3(3,3,3)*3);
        O122J = 15*p3(1,2,2)-3*(p3(1,1,1)+p3(1,2,2)+p3(1,3,3));
        O133J = 15*p3(1,3,3)-3*(p3(1,1,1)+p3(1,2,2)+p3(1,3,3));
%         O133J = 15*p3(1,3,3)-3*(p3(1,1,3)+p3(3,2,2)+p3(3,3,3));
        O322J = 15*p3(3,2,2)-3*(p3(1,1,3)+p3(3,2,2)+p3(3,3,3));
        O332J = 15*p3(3,3,2)-3*(p3(1,1,2)+p3(2,2,2)+p3(3,3,2));
        p3(:,:,1) = [O111J O112J O113J; O112J O122J O123J; O113J O123J O133J];
        p3(:,:,2) = [O112J O122J O123J; O122J O222J O322J; O123J O322J O332J];
        p3(:,:,3) = [O113J O123J O133J; O123J O322J O332J; O133J O332J O333J];
        j = p3;
        j = 15*s;
	elseif numel(s) == 3^4
        % hexadecapole
        p4 = s;
        aux = 1i*ones(size(p4));
%         aux(1,1,1,1) = 24*p4(1,1,1,1)+18*p4(1,1,2,2)+18*p4(1,1,3,3)-90*p4(2,2,1,1)+9*p4(2,2,2,2)+18*p4(2,2,3,3)-90*p4(3,3,1,1)+9*p4(3,3,3,3);
%         aux(1,1,1,2) = 60*p4(1,1,1,2)-45*p4(1,2,2,2)-45*p4(1,2,3,3);
%         aux(1,1,2,2) = -12*p4(1,1,1,1)+96*p4(1,1,2,2)+6*p4(1,1,3,3)-15*p4(1,1,2,2)-12*p4(2,2,2,2)+6*p4(2,2,3,3)-15*p4(1,1,3,3)-15*p4(2,2,3,3)+3*p4(3,3,3,3);
%         aux(1,2,2,2) = -45*p4(1,1,1,2)+105*p4(1,2,2,2)-45*p4(1,2,2,2)-45*p4(1,2,3,3);
%         aux(2,2,2,2) = 9*p4(1,1,1,1)-72*p4(1,1,2,2)+18*p4(1,1,3,3)+24*p4(2,2,2,2)+18*p4(2,2,3,3)-90*p4(2,2,3,3)+9*p4(3,3,3,3);
%         aux(1,1,1,3) = 60*p4(1,1,1,3)-45*p4(1,2,2,3)-45*p4(1,3,3,3);
%         aux(1,1,2,3) = 90*p4(1,1,2,3)-15*p4(2,2,2,3)-15*p4(2,3,3,3);
%         aux(1,2,2,3) = -15*p4(1,1,1,3)+105*p4(1,2,2,3)-15*p4(1,2,2,3)-15*p4(1,3,3,3);
%         aux(2,2,2,3) = -45*p4(1,1,2,3)+60*p4(2,2,2,3)-45*p4(2,3,3,3);
%         aux(1,1,3,3) = -12*p4(1,1,1,1)+6*p4(1,1,2,2)+96*p4(1,1,3,3)-15*p4(1,1,2,2)+3*p4(2,2,2,2)-9*p4(2,2,3,3)-15*p4(1,1,3,3)-12*p4(3,3,3,3);
%         aux(1,2,3,3) = -15*p4(1,1,1,2)+105*p4(1,2,3,3)-15*p4(1,2,2,2)-15*p4(1,2,3,3);
%         aux(2,2,3,3) = 3*p4(1,1,1,1)-9*p4(1,1,2,2)-9*p4(1,1,3,3)-12*p4(2,2,2,2)+96*p4(2,2,3,3)-15*p4(2,2,3,3)-12*p4(3,3,3,3);
%         aux(1,3,3,3) = -45*p4(1,1,1,3)+105*p4(1,3,3,3)-45*p4(1,2,2,3)-45*p4(1,3,3,3);
%         aux(2,3,3,3) = -45*p4(1,1,2,3)-45*p4(2,2,2,3)+105*p4(2,3,3,3)-45*p4(2,3,3,3);
%         aux(3,3,3,3) = 9*p4(1,1,1,1)+18*p4(1,1,2,2)-72*p4(1,1,3,3)+9*p4(2,2,2,2)-72*p4(2,2,3,3)+24*p4(3,3,3,3);
aux(1,1,1,1) = 24*p4(1,1,1,1)-72*p4(1,1,2,2)-72*p4(1,1,3,3)+9*p4(2,2,2,2)+18*p4(2,2,3,3)+9*p4(3,3,3,3);
aux(1,1,1,2) = 60*p4(1,1,1,2)-45*p4(1,2,2,2)-45*p4(1,2,3,3);
aux(1,1,2,2) = -12*p4(1,1,1,1)+81*p4(1,1,2,2)-9*p4(1,1,3,3)-12*p4(2,2,2,2)-9*p4(2,2,3,3)+3*p4(3,3,3,3);
aux(1,2,2,2) = -45*p4(1,1,1,2)+60*p4(1,2,2,2)-45*p4(1,2,3,3);
aux(2,2,2,2) = 9*p4(1,1,1,1)-72*p4(1,1,2,2)+18*p4(1,1,3,3)+24*p4(2,2,2,2)-72*p4(2,2,3,3)+9*p4(3,3,3,3);
aux(1,1,1,3) = 60*p4(1,1,1,3)-45*p4(1,2,2,3)-45*p4(1,3,3,3);
aux(1,1,2,3) = 90*p4(1,1,2,3)-15*p4(2,2,2,3)-15*p4(2,3,3,3);
aux(1,2,2,3) = -15*p4(1,1,1,3)+90*p4(1,2,2,3)-15*p4(1,3,3,3);
aux(2,2,2,3) = -45*p4(1,1,2,3)+60*p4(2,2,2,3)-45*p4(2,3,3,3);
aux(1,1,3,3) = -12*p4(1,1,1,1)-9*p4(1,1,2,2)+81*p4(1,1,3,3)+3*p4(2,2,2,2)-9*p4(2,2,3,3)-12*p4(3,3,3,3);
aux(1,2,3,3) = -15*p4(1,1,1,2)-15*p4(1,2,2,2)+90*p4(1,2,3,3);
aux(2,2,3,3) = 3*p4(1,1,1,1)-9*p4(1,1,2,2)-9*p4(1,1,3,3)-12*p4(2,2,2,2)+81*p4(2,2,3,3)-12*p4(3,3,3,3);
aux(1,3,3,3) = -45*p4(1,1,1,3)-45*p4(1,2,2,3)+60*p4(1,3,3,3);
aux(2,3,3,3) = -45*p4(1,1,2,3)-45*p4(2,2,2,3)+60*p4(2,3,3,3);
aux(3,3,3,3) = 9*p4(1,1,1,1)+18*p4(1,1,2,2)-72*p4(1,1,3,3)+9*p4(2,2,2,2)-72*p4(2,2,3,3)+24*p4(3,3,3,3);
        for k=1:numel(aux)
            [I,J,K,L] = ind2sub(size(aux),k);
            ind = sort([I,J,K,L]);
            aux(k) = aux(ind(1),ind(2),ind(3),ind(4));
        end
        j = p4;
        j = 105*s;
    elseif numel(s) == 3^5
        % 32-pole
        p5 = s;
        aux = 1i*ones(size(p5));
        aux(1,1,1,1,1) = 120*p5(1,1,1,1,1)-600*p5(1,1,1,2,2)-600*p5(1,1,1,3,3)+225*p5(1,2,2,2,2)*+450*p5(1,2,2,3,3)+225*p5(1,3,3,3,3);
        aux(1,1,1,1,2) = 360*p5(1,1,1,1,2)-540*p5(1,1,2,2,2)-540*p5(1,1,2,3,3)+45*p5(2,2,2,2,2)*+90*p5(2,2,2,3,3)+45*p5(2,3,3,3,3);
        aux(1,1,1,2,2) = -60*p5(1,1,1,1,1)+615*p5(1,1,1,2,2)-15*p5(1,1,1,3,3)-270*p5(1,2,2,2,2)-225*p5(1,2,2,3,3)+45*p5(1,3,3,3,3);
        aux(1,1,2,2,2) = -270*p5(1,1,1,1,2)+615*p5(1,1,2,2,2)-225*p5(1,1,2,3,3)-60*p5(2,2,2,2,2)-15*p5(2,2,2,3,3)+45*p5(2,3,3,3,3);
        aux(1,2,2,2,2) = 45*p5(1,1,1,1,1)-540*p5(1,1,1,2,2)+90*p5(1,1,1,3,3)*+360*p5(1,2,2,2,2)-540*p5(1,2,2,3,3)+45*p5(1,3,3,3,3);
        aux(2,2,2,2,2) = 225*p5(1,1,1,1,2)-600*p5(1,1,2,2,2)*+450*p5(1,1,2,3,3)+120*p5(2,2,2,2,2)-600*p5(2,2,2,3,3)+225*p5(2,3,3,3,3);
        aux(1,1,1,1,3) = 360*p5(1,1,1,1,3)-540*p5(1,1,2,2,3)-540*p5(1,1,3,3,3)+45*p5(2,2,2,2,3)*+90*p5(2,2,3,3,3)+45*p5(3,3,3,3,3);
        aux(1,1,1,2,3) = 630*p5(1,1,1,2,3)-315*p5(1,2,2,2,3)-315*p5(1,2,3,3,3);
        aux(1,1,2,2,3) = -90*p5(1,1,1,1,3)+765*p5(1,1,2,2,3)-75*p5(1,1,3,3,3)-90*p5(2,2,2,2,3)-75*p5(2,2,3,3,3)*+15*p5(3,3,3,3,3);
        aux(1,2,2,2,3) = -315*p5(1,1,1,2,3)+630*p5(1,2,2,2,3)-315*p5(1,2,3,3,3);
        aux(2,2,2,2,3) = 45*p5(1,1,1,1,3)-540*p5(1,1,2,2,3)+90*p5(1,1,3,3,3)*+360*p5(2,2,2,2,3)-540*p5(2,2,3,3,3)+45*p5(3,3,3,3,3);
        aux(1,1,1,3,3) = -60*p5(1,1,1,1,1)-15*p5(1,1,1,2,2)*+615*p5(1,1,1,3,3)+45*p5(1,2,2,2,2)-225*p5(1,2,2,3,3)-270*p5(1,3,3,3,3);
        aux(1,1,2,3,3) = -90*p5(1,1,1,1,2)-75*p5(1,1,2,2,2)*+765*p5(1,1,2,3,3)+15*p5(2,2,2,2,2)-75*p5(2,2,2,3,3)-90*p5(2,3,3,3,3);
        aux(1,2,2,3,3) = 15*p5(1,1,1,1,1)-75*p5(1,1,1,2,2)-75*p5(1,1,1,3,3)-90*p5(1,2,2,2,2)+765*p5(1,2,2,3,3)-90*p5(1,3,3,3,3);
        aux(2,2,2,3,3) = 45*p5(1,1,1,1,2)-15*p5(1,1,2,2,2)-225*p5(1,1,2,3,3)-60*p5(2,2,2,2,2)+615*p5(2,2,2,3,3)-270*p5(2,3,3,3,3);
        aux(1,1,3,3,3) = -270*p5(1,1,1,1,3)-225*p5(1,1,2,2,3)*+615*p5(1,1,3,3,3)+45*p5(2,2,2,2,3)-15*p5(2,2,3,3,3)-60*p5(3,3,3,3,3);
        aux(1,2,3,3,3) = -315*p5(1,1,1,2,3)-315*p5(1,2,2,2,3)+630*p5(1,2,3,3,3);
        aux(2,2,3,3,3) = 45*p5(1,1,1,1,3)-225*p5(1,1,2,2,3)-15*p5(1,1,3,3,3)-270*p5(2,2,2,2,3)+615*p5(2,2,3,3,3)-60*p5(3,3,3,3,3);
        aux(1,3,3,3,3) = 45*p5(1,1,1,1,1)+90*p5(1,1,1,2,2)-540*p5(1,1,1,3,3)*+45*p5(1,2,2,2,2)-540*p5(1,2,2,3,3)+360*p5(1,3,3,3,3);
        aux(2,3,3,3,3) = 45*p5(1,1,1,1,2)+90*p5(1,1,2,2,2)-540*p5(1,1,2,3,3)*+45*p5(2,2,2,2,2)-540*p5(2,2,2,3,3)+360*p5(2,3,3,3,3);
        aux(3,3,3,3,3) = 225*p5(1,1,1,1,3)+450*p5(1,1,2,2,3)-600*p5(1,1,3,3,3)+225*p5(2,2,2,2,3)-600*p5(2,2,3,3,3)+120*p5(3,3,3,3,3);
        for k=1:numel(aux)
            [I,J,K,L,M] = ind2sub(size(aux),k);
            ind = sort([I,J,K,L,M]);
            aux(k) = aux(ind(1),ind(2),ind(3),ind(4),ind(5));
        end
        j = p5;
        j = (945)*p5;
    end
end

